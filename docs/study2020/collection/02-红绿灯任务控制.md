# 红绿灯任务控制

[[toc]]

红灯 3s 亮一次，绿灯 1s 亮一次，黄灯 2s 亮一次，让 3 个灯不断交替重复地亮

```js
function red() {
  console.log("red");
}
function green() {
  console.log("green");
}
function yellow() {
  console.log("yellow");
}
```

## callback 方案

```js
// 从最简单、最容易理解的callback方案入手
const task = (timer, light, callback) => {
  setTimeout(() => {
    if (light === "red") {
      red();
    } else if (light === "green") {
      green();
    } else if (light === "yellow") {
      yellow;
    }
    callback();
  }, timer);
};

const step = () => {
  task(3000, "red", () => {
    task(1000, "green", () => {
      task(2000, "yellow", step);
    });
  });
};

step();
```

## Promise 方案

```js
// Promise 方案
const task = (timer, light) => {
  new Promise((resolve, reject) => {
    setTimeout(() => {
      if (light === "red") {
        red();
      } else if (light === "green") {
        green();
      } else if (light === "yellow") {
        yellow;
      }
      resolve();
    }, timer);
  });
};

const step = () => {
  task(3000, "red")
    .then(() => task(1000, "green"))
    .then(() => task(2000, "yellow"))
    .then(step);
};

step();
```

## async/await 方案

```js
// async / await 方案
const taskRunner = async () => {
  await task(3000, "red");
  await task(1000, "green");
  await task(2000, "yellow");
  taskRunner();
};

taskRunner();
```
